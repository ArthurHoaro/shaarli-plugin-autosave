!function(){function e(){if(u*=1e3,f*=1e3,!document.querySelector("[name="+m+"]")||!document.querySelector("[name="+v+"]"))return void console.error("Shaarli autosave plugin has incorrect parameters. Try removing parameters autosave_FORMNAME and autosave_KEYNAME via the plugin administration.");if(n()){var e=r(),t=new Date(e._autosaveTime),a=t.toLocaleDateString()+" "+t.toLocaleTimeString();confirm("An existing draft from "+a+" has been found for this link. Do you want to load it? Otherwise, this draft will be complitely erased.")&&l()}setInterval(function(){i()},u)}function t(){return(new Date).getTime()}function a(){var e={},t=document.querySelectorAll("[name=linkform] [name]");for(var a in t){var o=t[a].name;["save_edit","cancel_edit","delete_link","token"].indexOf(o)<0&&"string"==typeof o&&o.length>0&&("checkbox"===t[a].type?e[o]=t[a].checked:"radio"===t[a].type?t[a].checked&&(e[o]=t[a].value):e[o]=t[a].value)}return e}function o(){return s+document.querySelector("[name="+v+"]").value}function n(){return localStorage.hasOwnProperty(o())}function r(e){return e||(e=o()),n(e)?JSON.parse(localStorage.getItem(e)):void 0}function i(){var e=a();e._autosaveTime=t();var n=o();"string"==typeof n&&n.length>s.length&&"object"==typeof e&&(localStorage.setItem(n.trim(),JSON.stringify(e)),console.log("Data saved")),c()}function l(){var e=document.querySelectorAll("[name="+m+"] [name]"),t=r();if(t)for(var a in e){var o=e[a],n=o.name;t.hasOwnProperty(n)&&("checkbox"===o.type?o.checked=t[n]:"radio"===o.type?o.value===t[n]&&(o.checked=!0):o.value=t[n])}}function c(){for(key in localStorage)if(0===key.indexOf(s)){var e=r(key);t()-e._autosaveTime>f&&(localStorage.removeItem(key),console.log("Key "+key+" removed."))}}var u=window.autosaveInterval||30,m=window.autosaveFormname||"linkform",v=window.autosaveKeyname||"lf_url",f=window.autosaveLifetime||18e3,s="autosave_";e()}();